CREATE TABLE BL_3NF.CE_SALES (
    SALE_ID            NUMBER(38) NOT NULL,
    SALE_SOURCE_SYSTEM VARCHAR2(50 CHAR) NOT NULL,
    SALE_SOURCE_ENTITY VARCHAR2(50 CHAR) NOT NULL,
    PRODUCT_ID         NUMBER(38) NOT NULL,
    DATE_ID            DATE NOT NULL,
    PROMOTION_ID       NUMBER(38) NOT NULL,
    CHANNEL_ID         NUMBER(38) NOT NULL,
    STORE_ID           NUMBER(38) NOT NULL,
    EMPLOYEE_ID        NUMBER(38) NOT NULL,
    CUSTOMER_ID        NUMBER(38) NOT NULL,
    SALE_COST          NUMBER(15, 3),
    SALE_PRICE         NUMBER(15, 3),
    SALE_QUANTITY      NUMBER(38),
    TA_UPDATE_DT       DATE NOT NULL,
    TA_INSERT_DT       DATE NOT NULL
)
    PARTITION BY RANGE (
        DATE_ID
    )
    ( 
	PARTITION bef_01_2020
        VALUES LESS THAN ( TO_DATE('01/01/2020', 'dd/mm/yyyy') ),
	PARTITION m_01_2020
        VALUES LESS THAN ( TO_DATE('01/02/2020', 'dd/mm/yyyy') ),
    PARTITION m_02_2020
        VALUES LESS THAN ( TO_DATE('01/03/2020', 'dd/mm/yyyy') ),
    PARTITION m_03_2020
        VALUES LESS THAN ( TO_DATE('01/04/2020', 'dd/mm/yyyy') ),
    PARTITION m_04_2020
        VALUES LESS THAN ( TO_DATE('01/05/2020', 'dd/mm/yyyy') ),
    PARTITION m_05_2020
        VALUES LESS THAN ( TO_DATE('01/06/2020', 'dd/mm/yyyy') ),
    PARTITION m_06_2020
        VALUES LESS THAN ( TO_DATE('01/07/2020', 'dd/mm/yyyy') ),
    PARTITION m_07_2020
        VALUES LESS THAN ( TO_DATE('01/08/2020', 'dd/mm/yyyy') ),
    PARTITION m_08_2020
        VALUES LESS THAN ( TO_DATE('01/09/2020', 'dd/mm/yyyy') ),
    PARTITION m_09_2020
        VALUES LESS THAN ( TO_DATE('01/10/2020', 'dd/mm/yyyy') ),
    PARTITION m_10_2020
        VALUES LESS THAN ( TO_DATE('01/11/2020', 'dd/mm/yyyy') ),
    PARTITION m_11_2020
        VALUES LESS THAN ( TO_DATE('01/12/2020', 'dd/mm/yyyy') ),
    PARTITION m_12_2020
        VALUES LESS THAN ( TO_DATE('01/01/2021', 'dd/mm/yyyy') ),
    PARTITION m_01_2021
        VALUES LESS THAN ( TO_DATE('01/02/2021', 'dd/mm/yyyy') ),
    PARTITION m_02_2021
        VALUES LESS THAN ( TO_DATE('01/03/2021', 'dd/mm/yyyy') ),
    PARTITION m_03_2021
        VALUES LESS THAN ( TO_DATE('01/04/2021', 'dd/mm/yyyy') ),
    PARTITION m_04_2021
        VALUES LESS THAN ( TO_DATE('01/05/2021', 'dd/mm/yyyy') ),
    PARTITION m_05_2021
        VALUES LESS THAN ( TO_DATE('01/06/2021', 'dd/mm/yyyy') ),
    PARTITION m_06_2021
        VALUES LESS THAN ( TO_DATE('01/07/2021', 'dd/mm/yyyy') ),
    PARTITION m_07_2021
        VALUES LESS THAN ( TO_DATE('01/08/2021', 'dd/mm/yyyy') ),
    PARTITION m_08_2021
        VALUES LESS THAN ( TO_DATE('01/09/2021', 'dd/mm/yyyy') ),
    PARTITION m_09_2021
        VALUES LESS THAN ( TO_DATE('01/10/2021', 'dd/mm/yyyy') ),
    PARTITION m_10_2021
        VALUES LESS THAN ( TO_DATE('01/11/2021', 'dd/mm/yyyy') ),
    PARTITION m_11_2021
        VALUES LESS THAN ( TO_DATE('01/12/2021', 'dd/mm/yyyy') ),
    PARTITION m_12_2021
        VALUES LESS THAN ( TO_DATE('01/01/2022', 'dd/mm/yyyy') ),
	PARTITION after_12_2021
        VALUES LESS THAN ( TO_DATE('31/12/9999', 'dd/mm/yyyy') )
		
    );

ALTER TABLE BL_3NF.CE_SALES
    ADD CONSTRAINT CE_SALES_CE_PRODUCT_FK FOREIGN KEY ( PRODUCT_ID )
        REFERENCES BL_3NF.CE_PRODUCTS ( PRODUCT_ID );

ALTER TABLE BL_3NF.CE_SALES
    ADD CONSTRAINT CE_SALES_CE_CHANNEL_FK FOREIGN KEY ( CHANNEL_ID )
        REFERENCES BL_3NF.CE_CHANNELS ( CHANNEL_ID );

ALTER TABLE BL_3NF.CE_SALES
    ADD CONSTRAINT CE_SALES_CE_STORE_FK FOREIGN KEY ( STORE_ID )
        REFERENCES BL_3NF.CE_STORES ( STORE_ID );

ALTER TABLE BL_3NF.CE_SALES
    ADD CONSTRAINT CE_SALES_CE_EMPLOYEE_FK FOREIGN KEY ( EMPLOYEE_ID )
        REFERENCES BL_3NF.CE_EMPLOYEES ( EMPLOYEE_ID );

ALTER TABLE BL_3NF.CE_SALES
    ADD CONSTRAINT CE_SALES_CE_CUSTOMER_FK FOREIGN KEY ( CUSTOMER_ID )
        REFERENCES BL_3NF.CE_CUSTOMERS ( CUSTOMER_ID );